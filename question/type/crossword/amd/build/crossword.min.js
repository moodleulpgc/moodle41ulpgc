define("qtype_crossword/crossword",["exports","qtype_crossword/crossword_grid"],(function(_exports,_crossword_grid){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.preview=_exports.htmlIsEmpty=_exports.attempt=void 0;
/**
   * JavaScript to make crossword question.
   *
   * @module qtype_crossword/crossword
   * @copyright 2022 The Open University
   * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const EMPTY_EDITOR_CONTENT=["<p></p>","<p><br></p>","<br>",'<p dir="rtl" style="text-align: right;"></p>','<p dir="rtl" style="text-align: right;"><br></p>','<p dir="ltr" style="text-align: left;"></p>','<p dir="ltr" style="text-align: left;"><br></p>',"<p>&nbsp;</p>","<p><br>&nbsp;</p>",'<p dir="rtl" style="text-align: right;">&nbsp;</p>','<p dir="rtl" style="text-align: right;"><br>&nbsp;</p>','<p dir="ltr" style="text-align: left;">&nbsp;</p>','<p dir="ltr" style="text-align: left;"><br>&nbsp;</p>'],htmlIsEmpty=htmlContent=>EMPTY_EDITOR_CONTENT.includes(htmlContent);_exports.htmlIsEmpty=htmlIsEmpty;_exports.attempt=options=>{new _crossword_grid.CrosswordGrid(options).buildCrossword()};_exports.preview=options=>{const element=document.querySelector(options.element);element&&(element.removeAttribute("disabled"),element.addEventListener("click",(function(event){event.preventDefault();const columnEl=document.querySelector('select[name="numcolumns"]'),rowEl=document.querySelector('select[name="numrows"]'),words=function(){const alphaRegex=/^[a-z]+/,numberAnswer=document.querySelectorAll('[id^="fitem_id_answer"]').length;let words=[];if(numberAnswer>0)for(let no=0;no<numberAnswer;no++){const coordinateEl=document.querySelector("#fgroup_id_coodinateoptions_"+no),answerEl=document.querySelector("#fitem_id_answer_"+no),clueEl=document.querySelector("#fitem_id_clue_"+no);let word={};if(word.no=no+1,!coordinateEl||!answerEl||!clueEl)continue;coordinateEl.querySelectorAll("select").forEach((selectEl=>{var _selectEl$name$match;const name=null===(_selectEl$name$match=selectEl.name.match(alphaRegex))||void 0===_selectEl$name$match?void 0:_selectEl$name$match.pop();word[name]=selectEl.selectedIndex})),word.answer=answerEl.querySelector('input[id^="id_answer"]').value.normalize("NFKC");let clueData=clueEl.querySelector('textarea[id^="id_clue_"]').value.trim();htmlIsEmpty(clueData)&&(clueData=""),word.clue=clueData,words.push(word)}return words}(options.target),settings={...options,words:words,colsNum:columnEl.options[columnEl.selectedIndex].text,rowsNum:rowEl.options[rowEl.selectedIndex].text};new _crossword_grid.CrosswordGrid(settings).previewCrossword()})))}}));

//# sourceMappingURL=crossword.min.js.map