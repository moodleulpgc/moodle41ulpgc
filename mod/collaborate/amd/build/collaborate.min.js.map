{"version":3,"file":"collaborate.min.js","sources":["../src/collaborate.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module javascript.\n *\n * @package\n * @copyright Copyright (c) 2016 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod/collaborate\n */\ndefine(['jquery'], function($) {\n\n    /**\n     * Does the browser support copying?\n     * @returns {bool}\n     */\n    var canCopy = function() {\n        // We have to test for either supported or enabled as this is not consistent across browsers.\n        return document.queryCommandSupported('copy') ||\n               document.queryCommandEnabled('copy');\n    };\n\n    /**\n     * Deselect Text.\n     */\n    var deselectText = function() {\n        if (document.selection) {\n            // Internet Explorer clear selection.\n            document.selection.empty();\n        } else {\n            // All other browsers clear selection.\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n        }\n    };\n\n    /**\n     * Copy text of specific element\n     * @param {node} element\n     * @constructor\n     */\n    var copyText = function(element) {\n        // Based on code found at:\n        // http://stackoverflow.com/questions/985272/selecting-text-in-an-element-akin-to-highlighting-with-your-mouse .\n        if (element instanceof $) {\n            element = element[0];\n        }\n\n        if (element.select) {\n            element.select();\n            document.execCommand('copy');\n            deselectText();\n            return;\n        }\n\n        var doc = document,\n            range,\n            selection;\n\n        if (doc.body.createTextRange) {\n            range = document.body.createTextRange();\n            range.moveToElementText(element);\n            range.select();\n            document.execCommand('copy');\n            deselectText();\n        } else if (window.getSelection) {\n            selection = window.getSelection();\n            range = document.createRange();\n            range.selectNodeContents(element);\n            selection.removeAllRanges();\n            selection.addRange(range);\n            document.execCommand('copy');\n            deselectText();\n        }\n    };\n\n    /**\n     * Apply \"click to copy\" events.\n     */\n    var applyClickToCopy = function() {\n        if (canCopy()) {\n            $('.copyablelink').addClass('enabled');\n            $('.copyablelink button').click(function(e){\n                e.preventDefault();\n                copyText($(this).parent('form').find('input'));\n                $(this).parent('form').addClass('copied');\n                $(this).parent('form').find('div').focus();\n            });\n        }\n    };\n\n    return {init:function(){applyClickToCopy();}};\n});\n"],"names":["define","$","deselectText","document","selection","empty","window","getSelection","removeAllRanges","applyClickToCopy","queryCommandSupported","queryCommandEnabled","addClass","click","e","preventDefault","element","select","execCommand","range","body","createTextRange","moveToElementText","createRange","selectNodeContents","addRange","copyText","this","parent","find","focus","init"],"mappings":";;;;;;;AA0BAA,qCAAO,CAAC,WAAW,SAASC,OAepBC,aAAe,WACXC,SAASC,UAETD,SAASC,UAAUC,QAGHC,OAAOC,eACbC,mBA+CdC,iBAAmB,YA7DZN,SAASO,sBAAsB,SAC/BP,SAASQ,oBAAoB,WA8DhCV,EAAE,iBAAiBW,SAAS,WAC5BX,EAAE,wBAAwBY,OAAM,SAASC,GACrCA,EAAEC,iBA1CC,SAASC,YAGhBA,mBAAmBf,IACnBe,QAAUA,QAAQ,IAGlBA,QAAQC,cACRD,QAAQC,SACRd,SAASe,YAAY,aACrBhB,mBAKAiB,MACAf,UAFMD,SAIFiB,KAAKC,kBACTF,MAAQhB,SAASiB,KAAKC,mBAChBC,kBAAkBN,SACxBG,MAAMF,SACNd,SAASe,YAAY,QACrBhB,gBACOI,OAAOC,eACdH,UAAYE,OAAOC,gBACnBY,MAAQhB,SAASoB,eACXC,mBAAmBR,SACzBZ,UAAUI,kBACVJ,UAAUqB,SAASN,OACnBhB,SAASe,YAAY,QACrBhB,gBAYIwB,CAASzB,EAAE0B,MAAMC,OAAO,QAAQC,KAAK,UACrC5B,EAAE0B,MAAMC,OAAO,QAAQhB,SAAS,UAChCX,EAAE0B,MAAMC,OAAO,QAAQC,KAAK,OAAOC,mBAKxC,CAACC,KAAK,WAAWtB"}