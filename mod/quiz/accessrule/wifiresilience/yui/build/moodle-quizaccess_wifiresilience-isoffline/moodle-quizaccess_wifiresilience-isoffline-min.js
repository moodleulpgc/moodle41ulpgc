YUI.add("moodle-quizaccess_wifiresilience-isoffline",(function(Y,NAME){M.quizaccess_wifiresilience=M.quizaccess_wifiresilience||{},M.quizaccess_wifiresilience.isoffline={SELECTORS:{QUIZ_FORM:"#responseform"},init:function(){if(this.form=Y.one(this.SELECTORS.QUIZ_FORM),this.form){var mod_quiz_navblock_title;quizaccess_wifiresilience_progress_step=8,$("#quizaccess_wifiresilience_result").html(M.util.get_string("loadingstep8","quizaccess_wifiresilience")),Y.one("#mod_quiz_navblock .content").append('<div id="quizaccess_wifiresilience_connection"><a href="#" class="response-download-link" title="'+M.util.get_string("savetheresponses","quizaccess_wifiresilience")+'"><div></div></a></div>'),document.querySelector("#mod_quiz_navblock").addEventListener("dblclick",(function(e){M.quizaccess_wifiresilience.autosave.sync_string_errors&&""!=M.quizaccess_wifiresilience.autosave.sync_string_errors&&(e.stopImmediatePropagation(),this.errorDialogue=new M.core.notification.info({id:"quiz-wifierror-dialogue",width:"30%",center:!0,modal:!0,visible:!1,draggable:!1}),this.errorDialogue.setStdModContent(Y.WidgetStdMod.HEADER,'<h1 id="moodle-quiz-wifierror-dialogue-header-text">'+M.util.get_string("currentissue","quizaccess_wifiresilience")+"</h1>",Y.WidgetStdMod.REPLACE),this.errorDialogue.setStdModContent(Y.WidgetStdMod.BODY,'<p style="margin:10px;">'+M.quizaccess_wifiresilience.autosave.sync_string_errors+"</p>",Y.WidgetStdMod.REPLACE),this.errorDialogue.render().show())})),window.addEventListener("load",(function(e){"onLine"in navigator&&(navigator.onLine?quizaccess_wifiresilience_onlinestatus("Online",!0):quizaccess_wifiresilience_onlinestatus("Offline",!1))}),!1),window.addEventListener("online",(function(e){quizaccess_wifiresilience_onlinestatus("Online",!0)}),!1),window.addEventListener("offline",(function(e){quizaccess_wifiresilience_onlinestatus("Offline",!1)}),!1),Y.log("Device Connectivity Status Sniffer Initialised","debug","[Wifiresilience-SW] Connection Status");var examviewportmaxwidth=$(window).width(),quizaccess_wifiresilience_progress;$(".quizaccess_wifiresilience_progress .quizaccess_wifiresilience_bar").animate({width:8*examviewportmaxwidth/10+"px"})}else Y.log("No response form found. Why did you try to set up download?","debug","[Wifiresilience-SW] Connection Status");function quizaccess_wifiresilience_onlinestatus(msg,connected){var el=document.querySelector("#quizaccess_wifiresilience_connection"),cxn_hidden=document.querySelector("#quizaccess_wifiresilience_hidden_cxn_status");if(connected?(cxn_hidden.value=1,M.quizaccess_wifiresilience.autosave.sync_string_errors="",el.classList?(el.classList.add("connected"),el.classList.remove("disconnected")):(el.addClass("connected"),el.removeClass("disconnected"))):(cxn_hidden.value=0,M.quizaccess_wifiresilience.autosave.sync_string_errors="No Connection",el.classList?(el.classList.remove("connected"),el.classList.add("disconnected")):(el.removeClass("connected"),el.addClass("disconnected"))),M.quizaccess_wifiresilience.autosave.connected=connected,Y.log("Device is: "+msg,"debug","[Wifiresilience-SW] Connection Status"),!connected){M.quizaccess_wifiresilience.autosave.locally_stored_data.responses=Y.IO.stringify(M.quizaccess_wifiresilience.autosave.form);var stringified_data=Y.JSON.stringify(M.quizaccess_wifiresilience.autosave.locally_stored_data);M.quizaccess_wifiresilience.localforage.save_status_records(stringified_data),Y.log("Device is Offline: Force Saving Exam Elements Status in indexedDB.","debug","[Wifiresilience-SW] Connection Status"),M.quizaccess_wifiresilience.localforage.save_attempt_records_encrypted(),Y.log("Device is Offline: Force Saving Exam Encrypted Emergency File in indexedDB.","debug","[Wifiresilience-SW] Connection Status")}}}}}),"@VERSION@",{requires:["base","node","event","event-valuechange","node-event-delegate","io-form","json","core_question_engine","mod_quiz"]});